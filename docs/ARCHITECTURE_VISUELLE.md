# ğŸ— ARCHITECTURE VISUELLE - RÃ©union Wiki

> SchÃ©mas et diagrammes pour comprendre l'architecture en un coup d'Å“il

---

## ğŸ“Š Vue d'ensemble du systÃ¨me

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UTILISATEUR                              â”‚
â”‚                      (Navigateur Web)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP/HTTPS
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         NGINX                                    â”‚
â”‚              (Reverse Proxy + Fichiers statiques)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ Unix Socket
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      GUNICORN                                    â”‚
â”‚                  (4 workers Python)                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FLASK APPLICATION                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚   Routes    â”‚  â”‚   Services   â”‚  â”‚   Database   â”‚          â”‚
â”‚  â”‚  (HTTP)     â”‚â”€â”€â”‚  (Business)  â”‚â”€â”€â”‚   (SQLite)   â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚         â”‚                â”‚                   â”‚                   â”‚
â”‚         â–¼                â–¼                   â–¼                   â”‚
â”‚   Templates         Forms              Context Mgrs             â”‚
â”‚   (Jinja2)         (WTForms)          (Transactions)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚  SQLite DB   â”‚
                  â”‚  (base.db)   â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Architecture en couches

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  COUCHE PRÃ‰SENTATION                          â”‚
â”‚                    app/routes/*.py                            â”‚
â”‚  â€¢ ReÃ§oit requÃªtes HTTP                                       â”‚
â”‚  â€¢ Valide formulaires (WTForms)                               â”‚
â”‚  â€¢ Appelle services                                           â”‚
â”‚  â€¢ Retourne templates                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  COUCHE MÃ‰TIER                                â”‚
â”‚                 app/services/*.py                             â”‚
â”‚  â€¢ Contient TOUTE la logique business                         â”‚
â”‚  â€¢ Toutes les requÃªtes SQL                                    â”‚
â”‚  â€¢ Validation mÃ©tier                                          â”‚
â”‚  â€¢ RÃ©utilisable par plusieurs routes                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  COUCHE DONNÃ‰ES                               â”‚
â”‚                  app/database.py                              â”‚
â”‚  â€¢ Context managers (db_transaction, db_query)                â”‚
â”‚  â€¢ Connexion SQLite                                           â”‚
â”‚  â€¢ Gestion automatique commit/rollback                        â”‚
â”‚  â€¢ Gestion des erreurs                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ SQLite   â”‚
           â”‚ base.db  â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Flux d'une requÃªte complÃ¨te

### Exemple : Rechercher "mÃ©tÃ©o"

```
1. UTILISATEUR
   â†“ Tape "mÃ©tÃ©o" et clique "Rechercher"
   
2. NAVIGATEUR
   â†“ GET /recherche?q=mÃ©tÃ©o
   
3. NGINX
   â†“ ReÃ§oit requÃªte HTTP
   â†“ Check Rate Limiting
   â†“ Proxy vers Gunicorn
   
4. GUNICORN
   â†“ Worker disponible prend la requÃªte
   
5. FLASK â†’ Routes (app/routes/public.py)
   â†“ search() dÃ©codÃ© par URL routing
   â†“ @limiter.limit("30 per minute") âœ…
   â†“ query = request.args.get("q")[:100] âœ…
   â†“ Logging: "Recherche: 'mÃ©tÃ©o'..."
   
6. FLASK â†’ Services (app/services/sites.py)
   â†“ search_sites("mÃ©tÃ©o", limit=30)
   
7. FLASK â†’ Database (app/database.py)
   â†“ with db_query() as conn:
   â†“     cur.execute("SELECT * FROM sites WHERE nom LIKE ?", ("%mÃ©tÃ©o%",))
   
8. SQLITE
   â†“ ExÃ©cute requÃªte SQL
   â†“ Retourne rÃ©sultats
   
9. Services
   â†“ Traite et retourne liste de sites
   
10. Routes
    â†“ render_template("search.html", results=results)
    
11. JINJA2
    â†“ GÃ©nÃ¨re HTML avec les rÃ©sultats
    â†“ Auto-escape pour sÃ©curitÃ© âœ…
    
12. FLASK
    â†“ Retourne Response HTML
    
13. GUNICORN â†’ NGINX â†’ NAVIGATEUR
    â†“ HTML affichÃ© Ã  l'utilisateur
```

---

## ğŸ“ Organisation des fichiers

```
reunion-wiki/
â”‚
â”œâ”€â”€ ğŸš€ POINT D'ENTRÃ‰E
â”‚   â”œâ”€â”€ app.py                    # Lance l'application
â”‚   â””â”€â”€ config.py                 # Configuration (dev/prod)
â”‚
â”œâ”€â”€ ğŸ“¦ APPLICATION (app/)
â”‚   â”‚
â”‚   â”œâ”€â”€ __init__.py               # Factory Flask
â”‚   â”‚   â””â”€â”€ create_app()          # CrÃ©e et configure l'app
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸŒ ROUTES (HTTP)
â”‚   â”‚   â”œâ”€â”€ public.py             # Routes publiques
â”‚   â”‚   â”‚   â”œâ”€â”€ accueil()
â”‚   â”‚   â”‚   â”œâ”€â”€ voir_categorie()
â”‚   â”‚   â”‚   â”œâ”€â”€ search()
â”‚   â”‚   â”‚   â”œâ”€â”€ formulaire()
â”‚   â”‚   â”‚   â””â”€â”€ talents()
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ admin.py              # Routes admin
â”‚   â”‚       â”œâ”€â”€ login()
â”‚   â”‚       â”œâ”€â”€ dashboard()
â”‚   â”‚       â”œâ”€â”€ edit_site()
â”‚   â”‚       â””â”€â”€ talents()
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”§ SERVICES (Logique)
â”‚   â”‚   â”œâ”€â”€ sites.py              # Gestion sites
â”‚   â”‚   â”‚   â”œâ”€â”€ get_admin_sites()
â”‚   â”‚   â”‚   â”œâ”€â”€ search_sites()
â”‚   â”‚   â”‚   â”œâ”€â”€ submit_site_proposal()
â”‚   â”‚   â”‚   â””â”€â”€ update_site_status()
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ talents.py            # Gestion talents
â”‚   â”‚   â”‚   â”œâ”€â”€ get_talents_data()
â”‚   â”‚   â”‚   â””â”€â”€ create_talent_proposal()
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ emails.py             # Envoi emails
â”‚   â”‚   â”‚   â””â”€â”€ send_submission_notification()
â”‚   â”‚   â”‚
â”‚   â”‚   â””â”€â”€ auth.py               # Authentification
â”‚   â”‚       â”œâ”€â”€ verify_admin_credentials()
â”‚   â”‚       â””â”€â”€ admin_required()
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ’¾ DATABASE
â”‚   â”‚   â””â”€â”€ database.py           # Connexion SQLite
â”‚   â”‚       â”œâ”€â”€ db_transaction()  # Context manager (write)
â”‚   â”‚       â”œâ”€â”€ db_query()        # Context manager (read)
â”‚   â”‚       â””â”€â”€ get_db_connection()
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ FORMULAIRES
â”‚   â”‚   â””â”€â”€ forms.py
â”‚   â”‚       â”œâ”€â”€ SiteForm
â”‚   â”‚       â”œâ”€â”€ TalentProposalForm
â”‚   â”‚       â””â”€â”€ AdminLoginForm
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“„ TEMPLATES (HTML)
â”‚   â”‚   â”œâ”€â”€ base.html             # Template parent
â”‚   â”‚   â”œâ”€â”€ index.html
â”‚   â”‚   â”œâ”€â”€ categorie.html
â”‚   â”‚   â”œâ”€â”€ search.html
â”‚   â”‚   â””â”€â”€ admin/
â”‚   â”‚       â”œâ”€â”€ dashboard.html
â”‚   â”‚       â””â”€â”€ edit_site.html
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¨ STATIC (CSS/JS/Images)
â”‚   â”‚   â”œâ”€â”€ style.css
â”‚   â”‚   â”œâ”€â”€ bootstrap/
â”‚   â”‚   â”œâ”€â”€ icons/
â”‚   â”‚   â””â”€â”€ talents/
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ›  UTILITAIRES
â”‚       â”œâ”€â”€ extensions.py         # Flask-Limiter
â”‚       â”œâ”€â”€ filters.py            # Filtres Jinja
â”‚       â”œâ”€â”€ hooks.py              # Headers sÃ©curitÃ©
â”‚       â””â”€â”€ errors.py             # Pages 404/500
â”‚
â”œâ”€â”€ ğŸ’¾ DONNÃ‰ES
â”‚   â””â”€â”€ data/
â”‚       â”œâ”€â”€ base.db               # Base SQLite
â”‚       â””â”€â”€ backups/              # Sauvegardes auto
â”‚
â”œâ”€â”€ ğŸ¤– SCRIPTS
â”‚   â””â”€â”€ scripts/
â”‚       â”œâ”€â”€ backup_base.py        # Backup manuel
â”‚       â”œâ”€â”€ init_db.py            # Init DB
â”‚       â””â”€â”€ export_sites.py       # Export CSV
â”‚
â””â”€â”€ ğŸ“š DOCUMENTATION
    â””â”€â”€ docs/
        â”œâ”€â”€ GUIDE_COMPLET.md      # â­ Guide complet
        â”œâ”€â”€ INDEX_RAPIDE.md       # Navigation rapide
        â””â”€â”€ AIDE_MEMOIRE.md       # Cheat sheet
```

---

## ğŸ” Couches de sÃ©curitÃ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UTILISATEUR                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘ Rate Limiting â•‘  â† Limite requÃªtes (30/min)
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  Validation   â•‘  â† Longueur ([:100])
    â•‘   d'entrÃ©e    â•‘     Type (int, email)
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘   WTForms     â•‘  â† Validation formulaire
    â•‘   + CSRF      â•‘     Token CSRF
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  Sanitization â•‘  â† Supprime HTML
    â•‘  (_sanitize)  â•‘     CaractÃ¨res dangereux
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  Honeypot     â•‘  â† DÃ©tecte bots
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘   Services    â•‘  â† Logique mÃ©tier
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘   RequÃªtes    â•‘  â† TOUJOURS paramÃ©trÃ©es
    â•‘      SQL      â•‘     execute("... WHERE id = ?", (id,))
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘   Jinja2      â•‘  â† Auto-escape HTML
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RÃ‰PONSE SÃ‰CURISÃ‰E                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—„ SchÃ©ma de base de donnÃ©es

```sql
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              TABLE: sites               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id               INTEGER PRIMARY KEY    â”‚
â”‚ nom              TEXT NOT NULL          â”‚
â”‚ ville            TEXT                   â”‚
â”‚ lien             TEXT NOT NULL          â”‚
â”‚ description      TEXT NOT NULL          â”‚
â”‚ categorie        TEXT NOT NULL          â”‚
â”‚ status           TEXT (en_attente/      â”‚
â”‚                       valide/refuse)    â”‚
â”‚ en_vedette       INTEGER (0/1)         â”‚
â”‚ display_order    INTEGER                â”‚
â”‚ date_ajout       TEXT (DATETIME)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1:N (une catÃ©gorie = N sites)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             TABLE: talents              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id               INTEGER PRIMARY KEY    â”‚
â”‚ pseudo           TEXT NOT NULL          â”‚
â”‚ instagram        TEXT NOT NULL          â”‚
â”‚ description      TEXT NOT NULL          â”‚
â”‚ category         TEXT                   â”‚
â”‚ image            TEXT                   â”‚
â”‚ status           TEXT                   â”‚
â”‚ display_order    INTEGER                â”‚
â”‚ date_created     TEXT                   â”‚
â”‚ date_updated     TEXT                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Ã‰tats possibles (status)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  en_attente  â”‚ â† Proposition soumise
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚ valide  â”‚ â† Visible sur le site
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â””â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ refuse  â”‚ â† MasquÃ© (mais conservÃ©)
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Cycle de vie d'une proposition

```
1. SOUMISSION
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Utilisateur remplit     â”‚
   â”‚ formulaire /formulaire  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ WTForms valide          â”‚
   â”‚ âœ… CSRF                 â”‚
   â”‚ âœ… Longueurs            â”‚
   â”‚ âœ… Honeypot             â”‚
   â”‚ âœ… Sanitization         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Service insÃ¨re en BDD   â”‚
   â”‚ status = 'en_attente'   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Email envoyÃ© Ã  admin    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. MODÃ‰RATION
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Admin se connecte       â”‚
   â”‚ /admin/login            â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Dashboard liste         â”‚
   â”‚ propositions en_attente â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”œâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    â”‚ Admin approuve   â”‚
            â”‚    â”‚ â†’ status=valide  â”‚
            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚              â”‚
            â”‚              â–¼
            â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚    â”‚ Site visible     â”‚
            â”‚    â”‚ sur le site      â”‚
            â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â””â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Admin refuse     â”‚
                 â”‚ â†’ status=refuse  â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚ Site masquÃ©      â”‚
                 â”‚ (conservÃ© en BDD)â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Architecture des templates

```
base.html (Structure commune)
â”œâ”€â”€ <head>
â”‚   â”œâ”€â”€ SEO meta tags
â”‚   â”œâ”€â”€ Bootstrap CSS
â”‚   â””â”€â”€ style.css
â”œâ”€â”€ <body>
â”‚   â”œâ”€â”€ <header>
â”‚   â”‚   â”œâ”€â”€ Logo
â”‚   â”‚   â””â”€â”€ Navigation
â”‚   â”œâ”€â”€ {% block content %} â† RemplacÃ© par pages enfants
â”‚   â””â”€â”€ <footer>
â”‚
â”œâ”€â”€ index.html (hÃ©rite de base.html)
â”‚   â””â”€â”€ {% block content %}
â”‚       â”œâ”€â”€ Section en vedette
â”‚       â”œâ”€â”€ Derniers sites
â”‚       â””â”€â”€ Formulaire proposition
â”‚
â”œâ”€â”€ categorie.html (hÃ©rite de base.html)
â”‚   â””â”€â”€ {% block content %}
â”‚       â”œâ”€â”€ Titre catÃ©gorie
â”‚       â””â”€â”€ Liste sites filtrÃ©s
â”‚
â”œâ”€â”€ search.html (hÃ©rite de base.html)
â”‚   â””â”€â”€ {% block content %}
â”‚       â”œâ”€â”€ Formulaire recherche
â”‚       â””â”€â”€ RÃ©sultats
â”‚
â””â”€â”€ admin/dashboard.html (hÃ©rite de base.html)
    â””â”€â”€ {% block content %}
        â”œâ”€â”€ Filtres
        â”œâ”€â”€ Tableau propositions
        â””â”€â”€ Actions (Approuver/Refuser)
```

---

## ğŸš¦ Flow d'authentification admin

```
1. ACCÃˆS PROTÃ‰GÃ‰
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ User â†’ /admin       â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ @admin_required     â”‚
   â”‚ Check session       â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”‚ session["admin_authenticated"] ?
          â”‚
          â”œâ”€ NON â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚          â”‚ Redirect        â”‚
          â”‚          â”‚ /admin/login    â”‚
          â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â””â”€ OUI â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚ AccÃ¨s autorisÃ©  â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. LOGIN
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ User â†’ /admin/login     â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ AdminLoginForm()        â”‚
   â”‚ - username              â”‚
   â”‚ - password              â”‚
   â”‚ - CSRF token            â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Rate Limiting           â”‚
   â”‚ Max 5 tentatives/min    â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ verify_credentials()    â”‚
   â”‚ âœ… timing-safe compare  â”‚
   â”‚ âœ… password hash check  â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â”œâ”€ INVALIDE â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚              â”‚ Log warning  â”‚
          â”‚              â”‚ Flash error  â”‚
          â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â””â”€ VALIDE â”€â”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                         â”‚ session[...] â”‚
                         â”‚ = True       â”‚
                         â”‚ Log info     â”‚
                         â”‚ Redirect     â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š Performance et optimisation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   UTILISATEUR                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             CACHE NAVIGATEUR                        â”‚
â”‚  â€¢ CSS/JS/Images (1 an)                            â”‚
â”‚  â€¢ Service Worker (PWA)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  NGINX                              â”‚
â”‚  â€¢ Cache statique                                  â”‚
â”‚  â€¢ Compression gzip                                â”‚
â”‚  â€¢ Buffers optimisÃ©s                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                GUNICORN                             â”‚
â”‚  â€¢ 4 workers (multiprocessing)                     â”‚
â”‚  â€¢ Keep-alive connections                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FLASK + SQLITE                         â”‚
â”‚  â€¢ Context managers (transactions)                 â”‚
â”‚  â€¢ Index optimisÃ©s                                 â”‚
â”‚  â€¢ ANALYZE rÃ©gulier                                â”‚
â”‚  â€¢ Connection pooling                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ğŸ¯ Ces diagrammes sont tes cartes mentales ! Reviens-y quand tu as besoin de visualiser le systÃ¨me.**

*DerniÃ¨re mise Ã  jour : 11 novembre 2025*

