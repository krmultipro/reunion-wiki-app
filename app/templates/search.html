{% extends "base.html" %}

{% block seo_title %}
{% if query %}
RÃ©sultats pour Â« {{ query }} Â» - RÃ©union Wiki
{% else %}
Rechercher un site - RÃ©union Wiki
{% endif %}
{% endblock %}

{% block seo_description %}
Retrouvez rapidement un site utile de La RÃ©union grÃ¢ce Ã  la recherche RÃ©union Wiki.
{% endblock %}

{% block content %}
<section class="search-page">
  <header class="search-page__header">
    <h1>Recherche</h1>
    <form action="{{ url_for('public.search') }}" method="get" class="search-page__form" role="search">
      <label class="sr-only" for="search-query">Rechercher un site</label>
      <input
        id="search-query"
        name="q"
        type="search"
        placeholder="Nom, catÃ©gorie, ville..."
        value="{{ query }}"
        required
        minlength="2"
      />
      <button type="submit" class="btn btn-primary">Rechercher</button>
    </form>
    {% if query %}
    <p class="search-page__summary">
      {{ total }} rÃ©sultat{{ 's' if total != 1 else '' }} pour
      <strong>Â« {{ query }} Â»</strong>
    </p>
    {% else %}
    <p class="search-page__summary">
      Tape au moins deux caractÃ¨res pour lancer une recherche.
    </p>
    {% endif %}
  </header>

  {% if total %}
  <div class="search-results">
    {% for site in results %}
    <article class="search-result-card">
      <header class="search-result-card__header">
        <h2>{{ site["nom"] }}</h2>
        <span class="search-result-card__category">{{ site["categorie"] }}</span>
      </header>
      <p class="search-result-card__description">
        {{ site["description"] }}
      </p>
      <footer class="search-result-card__footer">
        <a
          href="{{ site['lien'] }}"
          target="_blank"
          rel="noopener noreferrer"
          class="btn btn-primary"
        >
          Visiter le site â†—
        </a>
        <div class="search-result-card__meta">
          {% if site["ville"] %}
          <span>ğŸ“ {{ site["ville"] }}</span>
          {% endif %}
          <span>Mise Ã  jour : {{ site["date_ajout"]|format_date }}</span>
        </div>
      </footer>
    </article>
    {% endfor %}
  </div>
  {% elif query %}
  <p class="search-empty">
    Aucun site ne correspond Ã  ta recherche. Essaie un autre mot-clÃ© ou parcoure les catÃ©gories.
  </p>
  {% endif %}
</section>
{% endblock %}
